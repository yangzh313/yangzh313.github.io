- 一个SQL语句如何执行
	- 数据库软件的典型架构
	  collapsed:: true
		- 分层架构
			- Presentation Layer
			- Business Layer
			- Persistence Layer
			- Database Layer
		- 事件驱动架构
			- ![image.png](../assets/image_1666699869407_0.png)
		- 管道-过滤器架构
			- ![image.png](../assets/image_1666699980628_0.png)
		- 微核架构
			- ![image.png](../assets/image_1666700060073_0.png)
		-
	- MySQL软件架构
		- ![image.png](../assets/image_1666700326835_0.png)
		- 分析-优化-执行
	- 客户端如何连接MySQL数据库
		- 连接方式
			- TCP/IP连接
				- 任何平台都提供的连接方法
				- 步骤：
					- 三次握手建立TCP连接
					- 认证连接
						- 服务端->客户端：发送握手初始化包
						- 客户端->服务端：发送验证
						- 服务段->客户端：认证结果消息
					- 认证通过，客户端与服务段之间交互（命令执行）
						- 客户端->服务端：发送命令包（Command Packet）
						- 服务段->客户端：发送回应包
					- 断开连接
						- 客户端->服务端：发送推出命令包
					- 四次挥手断开TCP连接
				- MySQL TCP报文格式
					- ![image.png](../assets/image_1666701223652_0.png)
					- 抓包
						- wireshark(win)
						- tcpdump(linux)
			- 命名管道
				- 命名管道：同一台服务器通讯（win）
			- 共享内存
				- 服务端：配置--shared-memory
				- 客户端：配置--protocol=memory
			- UNIX域套接字
				- 服务端：配置--socket=/tmp/mysql.sock
				- 客户端：配置-S=/tmp/mysql.sock
		- 总结：
			- TCP/IP连接是MySQL最常用的连接方式
			- TCP/IP连接报文可以作为其他C/S架构的参考
			- 其他连接方式均限于本机连接，使用范围有限
	- 一个SQL语句是怎么执行的？
		- 查询缓存
			- 之前执行过的语句会以KV的形式缓存在内存中
			- 查询先前查找过的相同语句
			- 不推荐使用缓存：数据表修改后，会删除所有相关缓存
			- MySQL8.0已经去掉查询缓存
		- 分析器
			- 作用是知道你要干什么
			- 先做词法分析，识别sql语句中的关键字
			- 再做句法分析，识别sql语句是否符合语法
		- 优化器
			- 作用是知道怎么做
			- 主要工作是决定如何使用索引
		- 执行器
			- 校验权限、调用存储引擎
			- 首先校验此用户对目标数据有无权限
			- 以行为力度，调用存储引擎，执行SQL
			- 在没有索引的情况下，执行器会循环查询所有行
		- 存储引擎
			- 任务是将执行器的指令落实在数据文件上
	- MySQL常见存储引擎
		- InnodDB
			- 。5.5.5之后的默认
			- 支持事务、外键
		- MyISAM
			- MySQL5.5.5之前的默认存储引擎
			- 插入数据块
			- 空间利用率高
			- 不支持事务
		- Memory
			- 所有的数据都在内存中，速度快
			- 数据安全性差
		- Archive
			- 数据压缩、空间利用率高
			- 插入速度快
			- 不支持索引，查询性能差